$_auth.secret_key = 'test'

@get('/'):
	if not $_auth.status:
		respond('Not logged in!')
	else:
		respond('You are logged in!')

@get('/public'):
	respond('Anyone can view this')

&protected
@get('/auth'):
	print ($_auth.decode())
	respond('This is only viewable with a token')

@post('/login'):
	if $_body['username'] and $_body['password'] == 'password':
		$_auth.login($_body['username'], 30)

		respond({token: $_auth.token.decode('utf-8')})
	else:
		respond('Unable to verify')
